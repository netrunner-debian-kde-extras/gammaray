From: Jakub Adam <jakub.adam@ktknet.cz>
Date: Thu, 5 Jan 2012 00:57:49 +0100
Subject: widget-export-actions-location

Install libgammaray_widget_export_actions.so to /usr/lib/gammaray
as it is application private library. Fixes lintian warnings/errors:

package-name-doesnt-match-sonames
shlib-without-versioned-soname
postinst-must-call-ldconfig
---
 CMakeLists.txt                                 |    1 +
 core/tools/widgetinspector/CMakeLists.txt      |    2 +-
 core/tools/widgetinspector/widgetinspector.cpp |    2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 4254e18..e448b56 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -126,6 +126,7 @@ if(Qt5Core_FOUND)
 else()
   set(PLUGIN_INSTALL_DIR "${LIB_INSTALL_DIR}/qt4/plugins")
 endif()
+set(MODULE_INSTALL_DIR "${LIB_INSTALL_DIR}/gammaray")
 
 set(
   INSTALL_TARGETS_DEFAULT_ARGS
diff --git a/core/tools/widgetinspector/CMakeLists.txt b/core/tools/widgetinspector/CMakeLists.txt
index 94d8798..0a22d8b 100644
--- a/core/tools/widgetinspector/CMakeLists.txt
+++ b/core/tools/widgetinspector/CMakeLists.txt
@@ -12,4 +12,4 @@ target_link_libraries(gammaray_widget_export_actions
   ${QT_QTDESIGNER_LIBRARIES}
 )
 
-install(TARGETS gammaray_widget_export_actions ${INSTALL_TARGETS_DEFAULT_ARGS})
+install(TARGETS gammaray_widget_export_actions DESTINATION ${MODULE_INSTALL_DIR})
diff --git a/core/tools/widgetinspector/widgetinspector.cpp b/core/tools/widgetinspector/widgetinspector.cpp
index 6d9bded..9af5048 100644
--- a/core/tools/widgetinspector/widgetinspector.cpp
+++ b/core/tools/widgetinspector/widgetinspector.cpp
@@ -279,7 +279,7 @@ void WidgetInspector::callExternalExportAction(const char *name,
 {
   if (!m_externalExportActions.isLoaded()) {
     const QString probePath =
-      QString::fromLocal8Bit(qgetenv("GAMMARAY_PROBE_PATH"));
+      QString::fromLocal8Bit(qgetenv("GAMMARAY_PROBE_PATH") + "/gammaray");
 
     m_externalExportActions.setFileName(
       probePath + QLatin1String("/libgammaray_widget_export_actions"));
